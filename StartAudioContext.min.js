(function(root,factory){if(typeof define==="function"&&define.amd){define([],factory)}else if(typeof module==="object"&&module.exports){module.exports=factory()}else{root.StartAudioContext=factory()}})(this,function(){var StartAudioContext={context:null,_tapListeners:[],_onTapCallbacks:[]};StartAudioContext.setContext=function(ctx){StartAudioContext.context=ctx;return StartAudioContext};StartAudioContext.on=function(element){if(Array.isArray(element)||NodeList&&element instanceof NodeList){for(var i=0;i<element.length;i++){StartAudioContext.on(element[i])}}else if(typeof element==="string"){StartAudioContext.on(document.querySelectorAll(element))}else if(element.jquery&&typeof element.toArray==="function"){StartAudioContext.on(element.toArray())}else if(Element&&element instanceof Element){var tap=new TapListener(element,onTap);StartAudioContext._tapListeners.push(tap)}return StartAudioContext};StartAudioContext.onTap=function(callback){StartAudioContext._onTapCallbacks.push(callback);return StartAudioContext};StartAudioContext.isStarted=function(){return StartAudioContext.context!==null&&StartAudioContext.context.state==="running"};var TapListener=function(element){this._dragged=false;this._element=element;this._bindedMove=this._moved.bind(this);this._bindedEnd=this._ended.bind(this);element.addEventListener("touchmove",this._bindedMove);element.addEventListener("touchend",this._bindedEnd);element.addEventListener("mouseup",this._bindedEnd)};TapListener.prototype._moved=function(e){this._dragged=true};TapListener.prototype._ended=function(e){if(!this._dragged){onTap()}this._dragged=false};TapListener.prototype.dispose=function(){this._element.removeEventListener("touchmove",this._bindedMove);this._element.removeEventListener("touchend",this._bindedEnd);this._element.removeEventListener("mouseup",this._bindedEnd);this._bindedMove=null;this._bindedEnd=null;this._element=null};function onTap(){if(StartAudioContext.context&&!StartAudioContext.isStarted()){var osc=StartAudioContext.context.createOscillator();var silent=StartAudioContext.context.createGain();silent.gain.value=0;osc.connect(silent);silent.connect(StartAudioContext.context.destination);var now=StartAudioContext.context.currentTime;osc.start(now);osc.stop(now+.5)}if(StartAudioContext._tapListeners){for(var i=0;i<StartAudioContext._tapListeners.length;i++){StartAudioContext._tapListeners[i].dispose()}StartAudioContext._tapListeners=null}if(StartAudioContext._onTapCallbacks){for(var j=0;j<StartAudioContext._onTapCallbacks.length;j++){StartAudioContext._onTapCallbacks[j]()}StartAudioContext._onTapCallbacks=null}}return StartAudioContext});